<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>iBetelgeuse: ARDerivativeSmoothQuaternionFilter Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.0 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<h1>ARDerivativeSmoothQuaternionFilter Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="ARDerivativeSmoothQuaternionFilter" --><!-- doxytag: inherits="ARQuaternionFilter" -->
<p><code>#import &lt;<a class="el" href="_a_r_derivative_smooth_quaternion_filter_8h_source.html">ARDerivativeSmoothQuaternionFilter.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for ARDerivativeSmoothQuaternionFilter:</div>
<div class="dyncontent">
 <div class="center">
  <img src="interface_a_r_derivative_smooth_quaternion_filter.png" usemap="#ARDerivativeSmoothQuaternionFilter_map" alt=""/>
  <map id="ARDerivativeSmoothQuaternionFilter_map" name="ARDerivativeSmoothQuaternionFilter_map">
<area href="interface_a_r_quaternion_filter.html" alt="ARQuaternionFilter" shape="rect" coords="0,56,220,80"/>
<area href="class_n_s_object.html" alt="NSObject" shape="rect" coords="0,0,220,24"/>
</map>
</div>

<p><a href="class_a_r_derivative_smooth_quaternion_filter-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(id)&nbsp;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_a_r_derivative_smooth_quaternion_filter.html#a3e04bb78e8fe66d43f6b5e348d72810c">initWithBaseCorrectionFactor:correctionFactorDerivativeGain:stabilizerAngularVelocity:derivativeAverageWindowSize:correctingInputAverageWindowSize:</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Instead of smoothening the input signal, this filter smoothens the derivative of the signal. Due to the derivative, smoothing, and reintegration steps, the output value may diverge from the real value. A correction factor is used to avoid this behaviour. The estimated value is corrected with the input value, with exponential convergence (the correction 'speed' is proportional to the difference between input and estimate).</p>
<p>This works under the assumption that the derivative is continuous and changes relatively slowly. Under these assumptions, this filter should stay closer to the actual function value than filters that do not use the derivative, but may cause a slight overshoot.</p>
<p>Since this is a quaternion filter, instead of taking the derivative of the quaternion directly (which does not have to be continuous), we compute the anglar velocity and smoothen that. For the same reason, we use the spherical moving average, rather than the moving average of the quaternion's components.</p>
<p>Several methods are used to improve this filter:</p>
<ul>
<li>To reduce overshoot and achieve faster convergence, the correction factor is increased proportionally to the angular velocity. correctionFactorDerivativeGain controls this.</li>
<li>A stabilizer is added, to dampen small derivatives. This causes a slight delay between movement of the device and filter response, especially for slow movements, but reduces the jitter caused by noise.</li>
<li>the correction factor is not based on the last sample, but on the average of the last few samples. The amount of samples for this filter is controlled by correctingInputAverageFilter </li>
</ul>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a3e04bb78e8fe66d43f6b5e348d72810c"></a><!-- doxytag: member="ARDerivativeSmoothQuaternionFilter::initWithBaseCorrectionFactor:correctionFactorDerivativeGain:stabilizerAngularVelocity:derivativeAverageWindowSize:correctingInputAverageWindowSize:" ref="a3e04bb78e8fe66d43f6b5e348d72810c" args="(double aBaseCorrectionFactor,[correctionFactorDerivativeGain] double aCorrectionFactorDerivativeGain,[stabilizerAngularVelocity] double aStabilizerAngularVelocity,[derivativeAverageWindowSize] int aDerivativeAverageWindowSize,[correctingInputAverageWindowSize] int aCorrectingInputAverageWindowSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (id) initWithBaseCorrectionFactor: </td>
          <td></td>
          <td class="paramtype">(double)&nbsp;</td>
          <td class="paramname"> <em>aBaseCorrectionFactor</em></td>
        </tr>
        <tr>
          <td class="paramkey">correctionFactorDerivativeGain:</td>
          <td></td>
          <td class="paramtype">(double)&nbsp;</td>
          <td class="paramname"> <em>aCorrectionFactorDerivativeGain</em></td>
        </tr>
        <tr>
          <td class="paramkey">stabilizerAngularVelocity:</td>
          <td></td>
          <td class="paramtype">(double)&nbsp;</td>
          <td class="paramname"> <em>aStabilizerAngularVelocity</em></td>
        </tr>
        <tr>
          <td class="paramkey">derivativeAverageWindowSize:</td>
          <td></td>
          <td class="paramtype">(int)&nbsp;</td>
          <td class="paramname"> <em>aDerivativeAverageWindowSize</em></td>
        </tr>
        <tr>
          <td class="paramkey">correctingInputAverageWindowSize:</td>
          <td></td>
          <td class="paramtype">(int)&nbsp;</td>
          <td class="paramname"> <em>aCorrectingInputAverageWindowSize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialize the filter. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>aBaseCorrectionFactor</em>&nbsp;</td><td>The correction factor when the derivative is 0. High values cause faster convergence, but also introduce more jitter. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>aCorrectionFactorDerivativeGain</em>&nbsp;</td><td>The correction factor is increased by this value times the length of the angular velocity. This allows for faster convergence. High values introduce more jitter but faster convergence. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>aStabilizerAngularVelocity</em>&nbsp;</td><td>The maximum angular velocity to cancel out. Increasing this value improves stability, but reduce movement smoothness. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>aDerivativeAverageWindowSize</em>&nbsp;</td><td>The filter that averages the derivative. Increasing this value gives a smoother value, but a larger delay. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>aCorrectingInputAverageWindowSize</em>&nbsp;</td><td>The filter that averages the corrector value. Increasing this reduces jitter, but gives a larger delay. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the initialized filter. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Sources/<a class="el" href="_a_r_derivative_smooth_quaternion_filter_8h_source.html">ARDerivativeSmoothQuaternionFilter.h</a></li>
<li>Sources/<a class="el" href="_a_r_derivative_smooth_quaternion_filter_8m.html">ARDerivativeSmoothQuaternionFilter.m</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Jul 6 2010 08:57:30 for iBetelgeuse by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.0 </small></address>
</body>
</html>
